---

 - name: create directory for scripts
   become: yes
   file: 
     path=/usr/share/systemd
     state=directory

 - name: create script for service
   become: yes
   template:
     src: vault.sh.j2
     dest: /usr/share/systemd/vault.sh
     mode: 0744
   notify: restart vault

 - name: create systemd service
   become: yes
   template:
     src: vault.service.j2
     dest: /etc/systemd/system/vault.service
   notify: restart vault

 - name: enable service at boot
   become: yes
   systemd:
     name: vault
     enabled: yes

 - name: create directory for config
   become: yes
   file: 
     path=/usr/local/etc/vault/
     state=directory

 - name: create config file
   become: yes
   template:
     src: vault.hcl.j2
     dest: /usr/local/etc/vault/vault.hcl
   notify: restart vault

 - name: create directory for data
   become: yes
   file: 
     path=/var/lib/vault
     state=directory



