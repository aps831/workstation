---

 - name: install desktop packages
   become: yes
   apt:
     name: "{{ packages }}"
   vars:
     packages:
     - coreutils # shred
     - redshift
     - redshift-gtk

# dconf does not play nicely with ansible_user when playbook is run locally.
 - name: set username
   set_fact: desktop_user="{{ ansible_user }}"

 - name: set list view for new folders
   become_user: "{{ desktop_user }}"
   dconf: key="/org/nemo/preferences/default-folder-viewer" value="'list-view'"

 - name: set wallpaper file
   become_user: "{{ desktop_user }}"
   dconf: key="/org/cinnamon/desktop/background/picture-uri" value="'file:///home/{{ desktop_user }}/.wallpaper.png'"

 - name: centre wallpaper
   become_user: "{{ desktop_user }}"
   dconf: key="/org/cinnamon/desktop/background/picture-options" value="'centered'"

 - name: create nemo action for shred
   become: yes
   copy:
     src: shred.nemo_action
     dest: /usr/share/nemo/actions/shred.nemo_action

 - name: create bookmarks
   template:
     src: "bookmarks.{{ desktop_user }}.j2"
     dest: /home/{{ desktop_user }}/.config/gtk-3.0/bookmarks
